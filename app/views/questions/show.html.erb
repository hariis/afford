<div id="snippets" class='snippet-odd'>
    <%= render :partial => 'snippet_body', :object => @question, :locals => {:question => @question} %>
</div>
<br/>

<div>
  <div style="float:left;" id="prompt-user-response">
    <% if !current_user || (current_user && !@question.is_responded_by(current_user)) %>
           <%= link_to_function "Your Response?" do |page|
            page.show 'user-response'
            page.hide 'expert-response'
            page.hide "financial-details"
            page.hide "p_more_link_up"
            page.show "p_more_link_down"
           end %>
      <% end %>
  </div>
  <div style="float:right;">
     <%= link_to_function "View Expert's Response" do |page|
        page.hide 'user-response'
        page.show 'expert-response'
        page.hide "financial-details"
        page.hide "p_more_link_up"
        page.show "p_more_link_down"
       end %>
   </div>
</div>

<%= link_to_function( "View Financial Details",  :id => "p_more_link_down", :style => 'display:none;') do |page|
        page.visual_effect  :toggle_blind, "financial-details"
        page.show "p_more_link_up"
        page.hide "p_more_link_down"
 end  %>

 <%= link_to_function( "Hide Financial Details",  :id => "p_more_link_up") do |page|
        page.visual_effect  :toggle_blind, "financial-details"
        page.hide "p_more_link_up"
        page.show "p_more_link_down"
 end  %>

      <div id="user-response" style="display:none;margin-top:20px;">

        <% if current_user %>          
            <%  form_remote_for @response, :url => { :controller => 'responses', :action => "create", :id => "#{@question.id}" },
                      :before => "Element.show('spinner');",:complete => "Element.hide('spinner')" do |f| %>
                   
                      <p>
                        <%= f.label "What is your Reasoning?" %><br />
                        <%= f.text_area 'reason', :rows => 4, :cols => 80  %>
                      </p>
                      <p>
                        <%= f.label "Your Response?" %><br />
                        <%= f.radio_button 'verdict', "1" %>Yes
                        <%= f.radio_button 'verdict', "0" %>No
                      </p>
                  <div style="margin-top: 10px;">
                  <%= f.submit 'Submit' %><%= image_tag 'loading.gif', :id=>"spinner", :style=>"display:none;" %>
                  </div>
           <% end %>
        <% else %>
                  <ul>
                    <li><%= link_to "New? Register", register_path %> |
                     <%= link_to "Already Registered? Log in", login_path %>   </li>
                  </ul>
        <% end %>
    </div>
<div id="user-response-status" style="color:red;"></div>
<div id="expert-response" style="display:none;margin-top:30px;">
    <fieldset>
      <legend><b>Expert Verdict</b></legend>
      <% if @question.expert_details.blank? %>
          <div class='expert-denied'>Expert does not have sufficient data</div>
      <% else %>
          <% if @question.expert_verdict == true %>
            <div class='expert-approved'>You have been Approved. </div>
          <% else %>
            <div class='expert-denied'>You have been Denied.</div>
          <% end %>
      <% end %>
    </fieldset>

    <fieldset>
      <legend><b>Details</b></legend>
      <ul>
        <%= @question.expert_details %>
      </ul>
    </fieldset>
</div>

<div id="financial-details" style="margin-top:20px;">
     <%= render :partial => "financial_details", :object => @financial, :local => {:question => @question} %>
</div>

<br/>
<hr/>
<div style="float:right;clear:both;padding-top:5px;">
  <%= link_to image_tag('/images/ask.png'), {:controller => :questions , :action => :new} %>
  </div>
<br/>
<div id="all-responses">
  <h2 style="margin-left:8px"><a name="responses">Community Responses (<%= @question.responses.size %>)</a></h2>
  <div class="<%= cycle('snippet-odd','snippet-even') %>">
  <%= render :partial => 'responses/response', :collection => @question.responses %>
  </div
</div>
